{"version":3,"sources":["../../../../components/marketplace/listing-detail.tsx","../../../../components/marketplace/checkout-dialog.tsx","../../../../lib/payments/payment-utils.ts"],"sourcesContent":["\"use client\"\r\n\r\nimport { useState } from \"react\"\r\nimport { motion } from \"framer-motion\"\r\nimport {\r\n  Star,\r\n  Shield,\r\n  Hexagon,\r\n  Share2,\r\n  Heart,\r\n  ShoppingCart,\r\n  MessageSquare,\r\n  ExternalLink,\r\n  ChevronLeft,\r\n  ChevronRight,\r\n  Award,\r\n  Wallet,\r\n  CreditCard,\r\n  Banknote,\r\n  ArrowLeftRight,\r\n} from \"lucide-react\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { Badge } from \"@/components/ui/badge\"\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\"\r\nimport { Card, CardContent } from \"@/components/ui/card\"\r\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\"\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from \"@/components/ui/dialog\"\r\nimport Link from \"next/link\"\r\nimport type { Listing } from \"@/lib/types\"\r\nimport { SwapProposalForm } from \"@/components/swap/swap-proposal-form\"\r\nimport { CheckoutDialog } from \"./checkout-dialog\"\r\n\r\ninterface ListingDetailProps {\r\n  listing: Listing & {\r\n    profiles?: {\r\n      id: string\r\n      full_name: string | null\r\n      avatar_url: string | null\r\n      reputation_score: number\r\n      is_verified: boolean\r\n      role: string\r\n    }\r\n    categories?: {\r\n      name: string\r\n      slug: string\r\n    }\r\n  }\r\n}\r\n\r\nexport function ListingDetail({ listing }: ListingDetailProps) {\r\n  const [currentImage, setCurrentImage] = useState(0)\r\n  const [isFavorite, setIsFavorite] = useState(false)\r\n  const [showSwapDialog, setShowSwapDialog] = useState(false)\r\n  const [showCheckout, setShowCheckout] = useState(false)\r\n\r\n  const images = listing.images?.length > 0 ? listing.images : [\"/product-marketplace-listing.jpg\"]\r\n\r\n  const nextImage = () => setCurrentImage((prev) => (prev + 1) % images.length)\r\n  const prevImage = () => setCurrentImage((prev) => (prev - 1 + images.length) % images.length)\r\n\r\n  const seller = listing.profiles\r\n\r\n  return (\r\n    <div className=\"pb-12\">\r\n      {/* Breadcrumb */}\r\n      <div className=\"mb-6\">\r\n        <Link href=\"/marketplace\" className=\"text-sm text-muted-foreground hover:text-primary transition-colors\">\r\n          ‚Üê Back to Marketplace\r\n        </Link>\r\n      </div>\r\n\r\n      <div className=\"grid lg:grid-cols-2 gap-8\">\r\n        {/* Images */}\r\n        <div className=\"space-y-4\">\r\n          <div className=\"relative aspect-[4/3] rounded-2xl overflow-hidden bg-secondary/30\">\r\n            <motion.img\r\n              key={currentImage}\r\n              initial={{ opacity: 0 }}\r\n              animate={{ opacity: 1 }}\r\n              src={images[currentImage] || \"/placeholder.svg\"}\r\n              alt={listing.title}\r\n              className=\"w-full h-full object-cover\"\r\n            />\r\n\r\n            {/* Navigation */}\r\n            {images.length > 1 && (\r\n              <>\r\n                <Button\r\n                  variant=\"secondary\"\r\n                  size=\"icon\"\r\n                  className=\"absolute left-4 top-1/2 -translate-y-1/2 rounded-full\"\r\n                  onClick={prevImage}\r\n                >\r\n                  <ChevronLeft className=\"h-5 w-5\" />\r\n                </Button>\r\n                <Button\r\n                  variant=\"secondary\"\r\n                  size=\"icon\"\r\n                  className=\"absolute right-4 top-1/2 -translate-y-1/2 rounded-full\"\r\n                  onClick={nextImage}\r\n                >\r\n                  <ChevronRight className=\"h-5 w-5\" />\r\n                </Button>\r\n              </>\r\n            )}\r\n\r\n            {/* Badges */}\r\n            <div className=\"absolute top-4 left-4 flex gap-2\">\r\n              {listing.is_verified && (\r\n                <Badge className=\"gap-1\">\r\n                  <Shield className=\"h-3 w-3\" />\r\n                  Verified\r\n                </Badge>\r\n              )}\r\n              {listing.is_tokenized && (\r\n                <Badge variant=\"secondary\" className=\"gap-1\">\r\n                  <Hexagon className=\"h-3 w-3\" />\r\n                  NFT\r\n                </Badge>\r\n              )}\r\n              {listing.swap_enabled && (\r\n                <Badge variant=\"secondary\" className=\"gap-1\">\r\n                  <ArrowLeftRight className=\"h-3 w-3\" />\r\n                  Swappable\r\n                </Badge>\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Thumbnails */}\r\n          {images.length > 1 && (\r\n            <div className=\"flex gap-2 overflow-x-auto pb-2\">\r\n              {images.map((img, i) => (\r\n                <button\r\n                  key={i}\r\n                  onClick={() => setCurrentImage(i)}\r\n                  className={`w-20 h-20 rounded-lg overflow-hidden shrink-0 border-2 transition-colors ${\r\n                    currentImage === i ? \"border-primary\" : \"border-transparent\"\r\n                  }`}\r\n                >\r\n                  <img src={img || \"/placeholder.svg\"} alt=\"\" className=\"w-full h-full object-cover\" />\r\n                </button>\r\n              ))}\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Details */}\r\n        <div>\r\n          <div className=\"flex items-start justify-between gap-4 mb-4\">\r\n            <div>\r\n              <p className=\"text-sm text-muted-foreground capitalize mb-1\">{listing.listing_type}</p>\r\n              <h1 className=\"text-3xl font-bold\">{listing.title}</h1>\r\n            </div>\r\n            <div className=\"flex gap-2\">\r\n              <Button\r\n                variant=\"outline\"\r\n                size=\"icon\"\r\n                onClick={() => setIsFavorite(!isFavorite)}\r\n                className=\"bg-transparent\"\r\n              >\r\n                <Heart className={`h-5 w-5 ${isFavorite ? \"fill-destructive text-destructive\" : \"\"}`} />\r\n              </Button>\r\n              <Button variant=\"outline\" size=\"icon\" className=\"bg-transparent\">\r\n                <Share2 className=\"h-5 w-5\" />\r\n              </Button>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Rating & Stats */}\r\n          <div className=\"flex items-center gap-4 mb-6\">\r\n            <div className=\"flex items-center gap-1\">\r\n              {[1, 2, 3, 4, 5].map((star) => (\r\n                <Star\r\n                  key={star}\r\n                  className={`h-5 w-5 ${star <= 4 ? \"fill-chart-4 text-chart-4\" : \"text-muted-foreground\"}`}\r\n                />\r\n              ))}\r\n              <span className=\"ml-2 text-sm text-muted-foreground\">(0 reviews)</span>\r\n            </div>\r\n            <span className=\"text-sm text-muted-foreground\">{listing.view_count || 0} views</span>\r\n          </div>\r\n\r\n          {/* Price */}\r\n          <div className=\"bg-secondary/30 rounded-xl p-6 mb-6\">\r\n            <div className=\"flex items-baseline gap-2 mb-4\">\r\n              <span className=\"text-4xl font-bold text-primary\">\r\n                {listing.price ? `$${listing.price.toFixed(2)}` : \"Contact for price\"}\r\n              </span>\r\n              {listing.is_tokenized && <span className=\"text-sm text-muted-foreground\">or crypto equivalent</span>}\r\n            </div>\r\n\r\n            <div className=\"flex flex-wrap gap-2 mb-4\">\r\n              <Badge variant=\"outline\" className=\"gap-1\">\r\n                <CreditCard className=\"h-3 w-3\" />\r\n                Card\r\n              </Badge>\r\n              <Badge variant=\"outline\" className=\"gap-1\">\r\n                <Banknote className=\"h-3 w-3\" />\r\n                Bank Transfer\r\n              </Badge>\r\n              {listing.is_tokenized && (\r\n                <Badge variant=\"outline\" className=\"gap-1\">\r\n                  <Wallet className=\"h-3 w-3\" />\r\n                  Crypto\r\n                </Badge>\r\n              )}\r\n            </div>\r\n\r\n            <div className=\"flex gap-3\">\r\n              <Button \r\n                className=\"flex-1 gap-2\"\r\n                onClick={() => setShowCheckout(true)}\r\n              >\r\n                <ShoppingCart className=\"h-5 w-5\" />\r\n                Buy Now\r\n              </Button>\r\n              {listing.swap_enabled && (\r\n                <Button\r\n                  variant=\"outline\"\r\n                  className=\"gap-2 bg-transparent\"\r\n                  onClick={() => setShowSwapDialog(true)}\r\n                >\r\n                  <ArrowLeftRight className=\"h-5 w-5\" />\r\n                  Propose Swap\r\n                </Button>\r\n              )}\r\n              {listing.is_tokenized && (\r\n                <Button variant=\"outline\" className=\"gap-2 bg-transparent\">\r\n                  <Wallet className=\"h-5 w-5\" />\r\n                  Make Offer\r\n                </Button>\r\n              )}\r\n            </div>\r\n            \r\n            {/* Swap Dialog */}\r\n            <Dialog open={showSwapDialog} onOpenChange={setShowSwapDialog}>\r\n              <DialogContent className=\"max-w-4xl max-h-[90vh] overflow-y-auto\">\r\n                <DialogHeader>\r\n                  <DialogTitle>Propose Swap</DialogTitle>\r\n                  <DialogDescription>\r\n                    Create a swap proposal for \"{listing.title}\"\r\n                  </DialogDescription>\r\n                </DialogHeader>\r\n                <SwapProposalForm\r\n                  targetListing={listing}\r\n                  targetUserId={listing.user_id}\r\n                  onClose={() => setShowSwapDialog(false)}\r\n                />\r\n              </DialogContent>\r\n            </Dialog>\r\n          </div>\r\n\r\n          {/* Seller */}\r\n          {seller && (\r\n            <Card className=\"mb-6\">\r\n              <CardContent className=\"p-6\">\r\n                <h3 className=\"font-semibold mb-4\">Seller Information</h3>\r\n                <div className=\"flex items-center gap-4 mb-4\">\r\n                  <Avatar className=\"h-12 w-12\">\r\n                    <AvatarImage src={seller.avatar_url || undefined} />\r\n                    <AvatarFallback>{seller.full_name?.charAt(0) || \"U\"}</AvatarFallback>\r\n                  </Avatar>\r\n                  <div className=\"flex-1\">\r\n                    <p className=\"font-semibold\">{seller.full_name || \"Anonymous\"}</p>\r\n                    <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\r\n                      {seller.is_verified && (\r\n                        <>\r\n                          <Shield className=\"h-3 w-3 text-primary\" />\r\n                          Verified {seller.role || \"Seller\"}\r\n                        </>\r\n                      )}\r\n                      <span className=\"flex items-center gap-1\">\r\n                        <Award className=\"h-3 w-3 text-chart-4\" />\r\n                        {seller.reputation_score || 0} pts\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Contact Options */}\r\n                <div className=\"space-y-3 border-t pt-4\">\r\n                  <h4 className=\"font-medium text-sm\">Contact Seller</h4>\r\n                  <div className=\"flex flex-col gap-2\">\r\n                    {seller.email && (\r\n                      <a \r\n                        href={`mailto:${seller.email}`}\r\n                        className=\"inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-secondary/50 hover:bg-secondary text-sm font-medium transition-colors\"\r\n                      >\r\n                        <MessageSquare className=\"h-4 w-4\" />\r\n                        Send Email\r\n                      </a>\r\n                    )}\r\n                    <Link href={`/dashboard/messages?to=${seller.id}`}>\r\n                      <Button variant=\"outline\" className=\"w-full gap-2 bg-transparent\" asChild>\r\n                        <a>\r\n                          <MessageSquare className=\"h-4 w-4\" />\r\n                          Send Message\r\n                        </a>\r\n                      </Button>\r\n                    </Link>\r\n                    <Link href={`/profiles/${seller.id}`}>\r\n                      <Button variant=\"outline\" className=\"w-full gap-2 bg-transparent\" asChild>\r\n                        <a>\r\n                          <ExternalLink className=\"h-4 w-4\" />\r\n                          View Profile\r\n                        </a>\r\n                      </Button>\r\n                    </Link>\r\n                  </div>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          )}\r\n\r\n          {/* Token Info */}\r\n          {listing.is_tokenized && listing.token_id && (\r\n            <Card className=\"mb-6\">\r\n              <CardContent className=\"p-4\">\r\n                <h3 className=\"font-semibold mb-3 flex items-center gap-2\">\r\n                  <Hexagon className=\"h-5 w-5 text-primary\" />\r\n                  Token Information\r\n                </h3>\r\n                <div className=\"space-y-2 text-sm\">\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"text-muted-foreground\">Token ID</span>\r\n                    <span className=\"font-mono\">{listing.token_id}</span>\r\n                  </div>\r\n                  {listing.contract_address && (\r\n                    <div className=\"flex justify-between\">\r\n                      <span className=\"text-muted-foreground\">Contract</span>\r\n                      <a href=\"#\" className=\"text-primary hover:underline flex items-center gap-1\">\r\n                        {listing.contract_address.slice(0, 10)}...\r\n                        <ExternalLink className=\"h-3 w-3\" />\r\n                      </a>\r\n                    </div>\r\n                  )}\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"text-muted-foreground\">Chain</span>\r\n                    <span>Ethereum</span>\r\n                  </div>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Tabs */}\r\n      <Tabs defaultValue=\"description\" className=\"mt-8\">\r\n        <TabsList>\r\n          <TabsTrigger value=\"description\">Description</TabsTrigger>\r\n          <TabsTrigger value=\"reviews\">Reviews</TabsTrigger>\r\n          <TabsTrigger value=\"details\">Details</TabsTrigger>\r\n        </TabsList>\r\n        <TabsContent value=\"description\" className=\"mt-6\">\r\n          <Card>\r\n            <CardContent className=\"p-6\">\r\n              <div className=\"prose prose-sm max-w-none dark:prose-invert\">\r\n                <p className=\"whitespace-pre-line\">{listing.description}</p>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n        <TabsContent value=\"reviews\" className=\"mt-6\">\r\n          <Card>\r\n            <CardContent className=\"p-6\">\r\n              <p className=\"text-muted-foreground text-center py-8\">No reviews yet. Be the first to review!</p>\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n        <TabsContent value=\"details\" className=\"mt-6\">\r\n          <Card>\r\n            <CardContent className=\"p-6\">\r\n              <div className=\"grid sm:grid-cols-2 gap-4\">\r\n                <div>\r\n                  <p className=\"text-sm text-muted-foreground\">Category</p>\r\n                  <p className=\"font-medium capitalize\">{listing.categories?.name || \"Uncategorized\"}</p>\r\n                </div>\r\n                <div>\r\n                  <p className=\"text-sm text-muted-foreground\">Type</p>\r\n                  <p className=\"font-medium capitalize\">{listing.listing_type}</p>\r\n                </div>\r\n                <div>\r\n                  <p className=\"text-sm text-muted-foreground\">Listed</p>\r\n                  <p className=\"font-medium\">{new Date(listing.created_at).toLocaleDateString()}</p>\r\n                </div>\r\n                <div>\r\n                  <p className=\"text-sm text-muted-foreground\">Views</p>\r\n                  <p className=\"font-medium\">{listing.view_count || 0}</p>\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n      </Tabs>\r\n\r\n      {/* Checkout Dialog */}\r\n      <CheckoutDialog\r\n        open={showCheckout}\r\n        onOpenChange={setShowCheckout}\r\n        listing={{\r\n          id: listing.id,\r\n          title: listing.title,\r\n          price: listing.price || 0,\r\n          currency: 'USD',\r\n          user_id: listing.user_id,\r\n        }}\r\n        onSuccess={(transactionId) => {\r\n          console.log('Purchase successful:', transactionId)\r\n        }}\r\n      />\r\n    </div>\r\n  )\r\n}\r\n","'use client'\r\n\r\nimport { useState } from 'react'\r\nimport { useRouter } from 'next/navigation'\r\nimport { createClient } from '@/lib/supabase/client'\r\nimport { processPayment, getPaymentMethods } from '@/lib/payments/payment-utils'\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from '@/components/ui/dialog'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\r\nimport { Input } from '@/components/ui/input'\r\nimport { Label } from '@/components/ui/label'\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'\r\nimport { Alert, AlertDescription } from '@/components/ui/alert'\r\nimport { RadioGroup, RadioGroupItem } from '@/components/ui/radio-group'\r\nimport { Loader2, ShoppingCart, CreditCard, Banknote, Wallet, AlertCircle } from 'lucide-react'\r\n\r\ninterface CheckoutDialogProps {\r\n  open: boolean\r\n  onOpenChange: (open: boolean) => void\r\n  listing: {\r\n    id: string\r\n    title: string\r\n    price: number\r\n    currency?: string\r\n    user_id: string\r\n  }\r\n  onSuccess?: (transactionId: string) => void\r\n}\r\n\r\nexport function CheckoutDialog({ open, onOpenChange, listing, onSuccess }: CheckoutDialogProps) {\r\n  const [step, setStep] = useState<'method' | 'confirm'>('method')\r\n  const [loading, setLoading] = useState(false)\r\n  const [error, setError] = useState('')\r\n  const [selectedMethod, setSelectedMethod] = useState<string>('')\r\n  const [paymentMethods, setPaymentMethods] = useState<any[]>([])\r\n  const [selectedProcessor, setSelectedProcessor] = useState<string>('')\r\n  const [selectedChain, setSelectedChain] = useState<string>('')\r\n  const [loadingMethods, setLoadingMethods] = useState(true)\r\n  const [addingTestMethod, setAddingTestMethod] = useState(false)\r\n\r\n  const router = useRouter()\r\n  const supabase = createClient()\r\n\r\n  // Load payment methods on open\r\n  const loadPaymentMethods = async () => {\r\n    try {\r\n      setLoadingMethods(true)\r\n      const result = await getPaymentMethods()\r\n      console.log('Payment methods result:', result)\r\n      if (result.success) {\r\n        setPaymentMethods(result.methods || [])\r\n        // Auto-select default method\r\n        const defaultMethod = result.methods?.find((m: any) => m.is_default)\r\n        if (defaultMethod) {\r\n          setSelectedMethod(defaultMethod.id)\r\n        }\r\n      } else {\r\n        console.error('Payment methods error:', result.error)\r\n        setError('Failed to load payment methods: ' + (result.error || 'Unknown error'))\r\n      }\r\n    } catch (err) {\r\n      console.error('Failed to load payment methods:', err)\r\n      setError('Error loading payment methods')\r\n    } finally {\r\n      setLoadingMethods(false)\r\n    }\r\n  }\r\n\r\n  const handleOpen = async (isOpen: boolean) => {\r\n    onOpenChange(isOpen)\r\n    if (isOpen) {\r\n      setError('')\r\n      setStep('method')\r\n      await loadPaymentMethods()\r\n    }\r\n  }\r\n\r\n  const handleAddTestMethod = async () => {\r\n    try {\r\n      setAddingTestMethod(true)\r\n      setError('')\r\n      const res = await fetch('/api/payments/methods/test-add')\r\n      const data = await res.json()\r\n      if (!res.ok) {\r\n        setError(data.error || 'Failed to create test payment method')\r\n      } else {\r\n        // reload methods and auto-select the new one\r\n        await loadPaymentMethods()\r\n        if (data?.method?.id) setSelectedMethod(data.method.id)\r\n      }\r\n    } catch (e) {\r\n      console.error('Add test method error:', e)\r\n      setError('Failed to create test payment method')\r\n    } finally {\r\n      setAddingTestMethod(false)\r\n    }\r\n  }\r\n\r\n  const handlePayment = async () => {\r\n    setLoading(true)\r\n    setError('')\r\n\r\n    try {\r\n      const {\r\n        data: { user },\r\n      } = await supabase.auth.getUser()\r\n      if (!user) {\r\n        router.push('/auth/sign-in')\r\n        return\r\n      }\r\n\r\n      // Process payment - use selected method if available\r\n      const paymentMethodId = selectedMethod || null\r\n      \r\n      const result = await processPayment({\r\n        method: 'card',\r\n        amount: listing.price,\r\n        currency: listing.currency || 'USD',\r\n        description: `Purchase: ${listing.title}`,\r\n        metadata: {\r\n          listing_id: listing.id,\r\n          listing_title: listing.title,\r\n          seller_id: listing.user_id,\r\n          payment_method_id: paymentMethodId,\r\n          transaction_type: 'purchase',\r\n          processor: selectedProcessor || undefined,\r\n          crypto_chain: selectedChain || undefined,\r\n        },\r\n      })\r\n\r\n      if (result.success) {\r\n        // Create transaction record in database\r\n        const { error: txError } = await supabase.from('transactions').insert({\r\n          user_id: user.id,\r\n          amount: listing.price,\r\n          type: 'purchase',\r\n          status: 'completed',\r\n          payment_method_id: paymentMethodId,\r\n          listing_id: listing.id,\r\n          description: `Purchased: ${listing.title}`,\r\n          external_reference: result.reference,\r\n          metadata: {\r\n            transaction_id: result.transactionId,\r\n            processor: selectedProcessor || (selectedChain ? `crypto_${selectedChain}` : result?.processor || 'stripe'),\r\n          },\r\n        })\r\n\r\n        if (!txError) {\r\n          // Show success\r\n          setStep('confirm')\r\n          setTimeout(() => {\r\n            handleOpen(false)\r\n            onSuccess?.(result.transactionId || '')\r\n            // Redirect to receipt or order page\r\n            router.push(`/dashboard/transactions?id=${result.transactionId}`)\r\n          }, 2000)\r\n        }\r\n      } else {\r\n        setError(result.error || 'Payment failed. Please try again.')\r\n      }\r\n    } catch (err) {\r\n      setError('Payment processing error. Please try again.')\r\n      console.error('Checkout error:', err)\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={handleOpen}>\r\n      <DialogContent className=\"max-w-md\">\r\n        <DialogHeader>\r\n          <DialogTitle>Purchase Item</DialogTitle>\r\n          <DialogDescription>Complete your purchase of {listing.title}</DialogDescription>\r\n        </DialogHeader>\r\n\r\n        {step === 'confirm' && (\r\n          <div className=\"text-center py-8 space-y-4\">\r\n            <div className=\"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto\">\r\n              <ShoppingCart className=\"h-6 w-6 text-green-600\" />\r\n            </div>\r\n            <div>\r\n              <h3 className=\"font-semibold text-lg\">Purchase Successful!</h3>\r\n              <p className=\"text-sm text-muted-foreground\">Your order is being processed.</p>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {step === 'method' && (\r\n          <div className=\"space-y-6\">\r\n            {/* Order Summary */}\r\n            <Card className=\"bg-muted/50 border-0\">\r\n              <CardContent className=\"p-4\">\r\n                <div className=\"space-y-2\">\r\n                  <p className=\"text-sm text-muted-foreground\">Order Total</p>\r\n                  <p className=\"text-2xl font-bold\">${listing.price.toFixed(2)}</p>\r\n                  <p className=\"text-xs text-muted-foreground\">{listing.title}</p>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {error && (\r\n              <Alert variant=\"destructive\">\r\n                <AlertCircle className=\"h-4 w-4\" />\r\n                <AlertDescription>{error}</AlertDescription>\r\n              </Alert>\r\n            )}\r\n\r\n            {/* Payment Methods */}\r\n            {loadingMethods ? (\r\n              <div className=\"text-center py-8\">\r\n                <Loader2 className=\"h-8 w-8 animate-spin mx-auto text-muted-foreground\" />\r\n              </div>\r\n            ) : paymentMethods.length > 0 ? (\r\n              <div className=\"space-y-3\">\r\n                <Label>Select Payment Method</Label>\r\n                <RadioGroup value={selectedMethod} onValueChange={setSelectedMethod}>\r\n                  {paymentMethods.map((method) => (\r\n                    <div key={method.id} className=\"flex items-center space-x-2 p-3 border rounded-lg\">\r\n                      <RadioGroupItem value={method.id} id={method.id} />\r\n                      <Label htmlFor={method.id} className=\"flex items-center gap-2 flex-1 cursor-pointer\">\r\n                        {method.type === 'card' && <CreditCard className=\"h-4 w-4\" />}\r\n                        {method.type === 'bank' && <Banknote className=\"h-4 w-4\" />}\r\n                        {method.type === 'crypto_wallet' && <Wallet className=\"h-4 w-4\" />}\r\n                        <span>\r\n                          {method.label || `${method.type} (${method.last_four})`}\r\n                        </span>\r\n                      </Label>\r\n                    </div>\r\n                  ))}\r\n                </RadioGroup>\r\n                <div className=\"mt-3\">\r\n                  <Button size=\"sm\" variant=\"ghost\" onClick={handleAddTestMethod} disabled={addingTestMethod}>\r\n                    {addingTestMethod ? (\r\n                      <>\r\n                        <Loader2 className=\"h-4 w-4 animate-spin mr-2\" />\r\n                        Adding...\r\n                      </>\r\n                    ) : (\r\n                      'Add Test Method'\r\n                    )}\r\n                  </Button>\r\n                </div>\r\n                {/* Processor / Chain selection based on selected method */}\r\n                {selectedMethod && (\r\n                  (() => {\r\n                    const m = paymentMethods.find((x) => x.id === selectedMethod)\r\n                    if (!m) return null\r\n                    if (m.type === 'card' || m.type === 'bank') {\r\n                      return (\r\n                        <div className=\"space-y-2\">\r\n                          <Label>Processor</Label>\r\n                          <Select onValueChange={(v) => setSelectedProcessor(v)}>\r\n                            <SelectTrigger>\r\n                              <SelectValue>{selectedProcessor || 'Choose processor'}</SelectValue>\r\n                            </SelectTrigger>\r\n                            <SelectContent>\r\n                              <SelectItem value=\"stripe\">Stripe</SelectItem>\r\n                              <SelectItem value=\"paystack\">Paystack</SelectItem>\r\n                              <SelectItem value=\"flutterwave\">Flutterwave</SelectItem>\r\n                            </SelectContent>\r\n                          </Select>\r\n                        </div>\r\n                      )\r\n                    }\r\n\r\n                    if (m.type === 'crypto_wallet') {\r\n                      return (\r\n                        <div className=\"space-y-2\">\r\n                          <Label>Network / Chain</Label>\r\n                          <Select onValueChange={(v) => setSelectedChain(v)}>\r\n                            <SelectTrigger>\r\n                              <SelectValue>{selectedChain || 'Choose network'}</SelectValue>\r\n                            </SelectTrigger>\r\n                            <SelectContent>\r\n                              <SelectItem value=\"ethereum\">Ethereum</SelectItem>\r\n                              <SelectItem value=\"arbitrum\">Arbitrum</SelectItem>\r\n                              <SelectItem value=\"optimism\">Optimism</SelectItem>\r\n                            </SelectContent>\r\n                          </Select>\r\n                        </div>\r\n                      )\r\n                    }\r\n\r\n                    return null\r\n                  })()\r\n                )}\r\n              </div>\r\n            ) : (\r\n              <div className=\"text-center py-6 space-y-3\">\r\n                <p className=\"text-sm text-muted-foreground\">No payment methods saved</p>\r\n                <p className=\"text-xs text-muted-foreground mb-4\">Please add a payment method before proceeding</p>\r\n                <div className=\"flex gap-2 justify-center\">\r\n                  <Button variant=\"outline\" onClick={() => { handleOpen(false); router.push('/dashboard/wallet/methods/add') }}>Add Payment Method</Button>\r\n                  <Button onClick={handleAddTestMethod} disabled={addingTestMethod}>\r\n                    {addingTestMethod ? (\r\n                      <>\r\n                        <Loader2 className=\"h-4 w-4 animate-spin mr-2\" />\r\n                        Adding...\r\n                      </>\r\n                    ) : (\r\n                      'Add Test Method'\r\n                    )}\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Action Buttons */}\r\n            <div className=\"flex gap-3\">\r\n              <Button\r\n                variant=\"outline\"\r\n                className=\"flex-1\"\r\n                onClick={() => handleOpen(false)}\r\n                disabled={loading}\r\n              >\r\n                Cancel\r\n              </Button>\r\n              <Button\r\n                className=\"flex-1 gap-2\"\r\n                onClick={handlePayment}\r\n                disabled={loading || !selectedMethod || (paymentMethods.find(m => m.id === selectedMethod)?.type === 'card' && !selectedProcessor) || (paymentMethods.find(m => m.id === selectedMethod)?.type === 'crypto_wallet' && !selectedChain)}\r\n              >\r\n                {loading ? (\r\n                  <>\r\n                    <Loader2 className=\"h-4 w-4 animate-spin\" />\r\n                    Processing...\r\n                  </>\r\n                ) : (\r\n                  <>\r\n                    <ShoppingCart className=\"h-4 w-4\" />\r\n                    Pay ${listing.price.toFixed(2)}\r\n                  </>\r\n                )}\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </DialogContent>\r\n    </Dialog>\r\n  )\r\n}\r\n","/**\r\n * Payment Utilities Library\r\n * Handles payment method validation, formatting, and processing\r\n */\r\n\r\nexport type PaymentMethod = \"card\" | \"bank\" | \"crypto\" | \"paystack\" | \"flutterwave\"\r\n\r\nexport interface PaymentConfig {\r\n  method: PaymentMethod\r\n  amount: number\r\n  currency: string\r\n  description?: string\r\n  metadata?: Record<string, any>\r\n}\r\n\r\nexport interface PaymentResult {\r\n  success: boolean\r\n  transactionId?: string\r\n  reference?: string\r\n  message: string\r\n  error?: string\r\n  nextAction?: string\r\n  processor?: string\r\n}\r\n\r\n// Validation functions\r\nexport const validateCardNumber = (cardNumber: string): boolean => {\r\n  const cleaned = cardNumber.replace(/\\s/g, \"\")\r\n  // Luhn algorithm\r\n  if (!/^\\d{13,19}$/.test(cleaned)) return false\r\n\r\n  let sum = 0\r\n  let isEven = false\r\n\r\n  for (let i = cleaned.length - 1; i >= 0; i--) {\r\n    let digit = parseInt(cleaned[i], 10)\r\n\r\n    if (isEven) {\r\n      digit *= 2\r\n      if (digit > 9) {\r\n        digit -= 9\r\n      }\r\n    }\r\n\r\n    sum += digit\r\n    isEven = !isEven\r\n  }\r\n\r\n  return sum % 10 === 0\r\n}\r\n\r\nexport const validateBankAccountNumber = (accountNumber: string): boolean => {\r\n  // Basic validation - customize based on your bank's requirements\r\n  return accountNumber.length >= 8 && /^\\d+$/.test(accountNumber)\r\n}\r\n\r\nexport const validateCryptoAddress = (address: string, type: string = \"ethereum\"): boolean => {\r\n  if (type === \"ethereum\") {\r\n    return /^0x[a-fA-F0-9]{40}$/.test(address)\r\n  }\r\n  // Add other crypto address validations as needed\r\n  return false\r\n}\r\n\r\nexport const validateIBAN = (iban: string): boolean => {\r\n  // Remove spaces and convert to uppercase\r\n  const normalizedIBAN = iban.replace(/\\s/g, \"\").toUpperCase()\r\n\r\n  // Check if IBAN format is correct (2 letters, 2 digits, then up to 30 alphanumeric)\r\n  if (!/^[A-Z]{2}[0-9]{2}[A-Z0-9]{1,30}$/.test(normalizedIBAN)) {\r\n    return false\r\n  }\r\n\r\n  // Validate checksum using mod-97 algorithm\r\n  let rearranged = normalizedIBAN.substring(4) + normalizedIBAN.substring(0, 4)\r\n  let numericIBAN = \"\"\r\n\r\n  for (let i = 0; i < rearranged.length; i++) {\r\n    const char = rearranged[i]\r\n    numericIBAN += char.charCodeAt(0) - (char >= \"A\" ? 55 : 48)\r\n  }\r\n\r\n  // Check if mod-97 of numeric IBAN is 1\r\n  let remainder = numericIBAN\r\n  while (remainder.length > 2) {\r\n    remainder = ((parseInt(remainder.substring(0, 9)) % 97) + remainder.substring(9)).toString()\r\n  }\r\n\r\n  return parseInt(remainder) % 97 === 1\r\n}\r\n\r\n// Formatting functions\r\nexport const formatCardNumber = (cardNumber: string): string => {\r\n  const cleaned = cardNumber.replace(/\\s/g, \"\")\r\n  return cleaned.replace(/(.{4})/g, \"$1 \").trim()\r\n}\r\n\r\nexport const formatCurrency = (amount: number, currency: string = \"USD\"): string => {\r\n  return new Intl.NumberFormat(\"en-US\", {\r\n    style: \"currency\",\r\n    currency,\r\n  }).format(amount)\r\n}\r\n\r\nexport const maskCardNumber = (cardNumber: string): string => {\r\n  if (cardNumber.length < 4) return cardNumber\r\n  const lastFour = cardNumber.slice(-4)\r\n  return `‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ${lastFour}`\r\n}\r\n\r\nexport const maskBankAccount = (accountNumber: string): string => {\r\n  if (accountNumber.length < 4) return accountNumber\r\n  const lastFour = accountNumber.slice(-4)\r\n  return `‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ${lastFour}`\r\n}\r\n\r\n// Transaction fee calculations\r\nexport const calculateFee = (\r\n  amount: number,\r\n  method: PaymentMethod,\r\n  currency: string = \"USD\"\r\n): { fee: number; total: number } => {\r\n  let fee = 0\r\n\r\n  switch (method) {\r\n    case \"card\":\r\n    case \"paystack\":\r\n      // Paystack: 1.5% + NGN 100 (if NGN) or standard 2.9% + $0.30 for international\r\n      if (currency === \"NGN\") {\r\n        fee = amount * 0.015 + 100\r\n      } else {\r\n        fee = amount * 0.029 + 0.3\r\n      }\r\n      break\r\n\r\n    case \"flutterwave\":\r\n      // Flutterwave: 1.4% for local, 3.8% for international\r\n      fee = amount * (currency === \"NGN\" ? 0.014 : 0.038)\r\n      break\r\n\r\n    case \"bank\":\r\n      // Bank transfer: No fee\r\n      fee = 0\r\n      break\r\n\r\n    case \"crypto\":\r\n      // Crypto: Network gas fees (estimated)\r\n      fee = 0 // User pays gas separately\r\n      break\r\n\r\n    default:\r\n      fee = 0\r\n  }\r\n\r\n  return {\r\n    fee: Math.round(fee * 100) / 100,\r\n    total: Math.round((amount + fee) * 100) / 100,\r\n  }\r\n}\r\n\r\n// Payment method detection from card number\r\nexport const detectCardType = (cardNumber: string): string => {\r\n  const number = cardNumber.replace(/\\D/g, \"\")\r\n\r\n  if (/^4[0-9]{12}(?:[0-9]{3})?$/.test(number)) return \"Visa\"\r\n  if (/^5[1-5][0-9]{14}$/.test(number)) return \"Mastercard\"\r\n  if (/^3[47][0-9]{13}$/.test(number)) return \"American Express\"\r\n  if (/^6(?:011|5[0-9]{2})[0-9]{12}$/.test(number)) return \"Discover\"\r\n  if (/^(?:2131|1800|35\\d{3})\\d{11}$/.test(number)) return \"JCB\"\r\n\r\n  return \"Unknown\"\r\n}\r\n\r\n// Get payment method icon\r\nexport const getPaymentMethodIcon = (method: PaymentMethod): string => {\r\n  const iconMap: Record<PaymentMethod, string> = {\r\n    card: \"üí≥\",\r\n    bank: \"üè¶\",\r\n    crypto: \"‚Çø\",\r\n    paystack: \"üü¢\",\r\n    flutterwave: \"üü†\",\r\n  }\r\n  return iconMap[method] || \"üí∞\"\r\n}\r\n\r\n// Payment status descriptions\r\nexport const getPaymentStatusDescription = (status: string): string => {\r\n  const descriptions: Record<string, string> = {\r\n    pending: \"Payment is pending. Please complete the transaction.\",\r\n    processing: \"Your payment is being processed. This may take a few moments.\",\r\n    completed: \"Payment completed successfully!\",\r\n    failed: \"Payment failed. Please try again or use a different payment method.\",\r\n    cancelled: \"Payment was cancelled.\",\r\n    refunded: \"Payment has been refunded to your account.\",\r\n  }\r\n  return descriptions[status] || \"Unknown status\"\r\n}\r\n\r\n// Export API functions\r\nexport async function processPayment(config: PaymentConfig): Promise<PaymentResult> {\r\n  try {\r\n    // Map config to API expected format\r\n    const payload = {\r\n      amount: config.amount,\r\n      currency: config.currency,\r\n      description: config.description,\r\n      payment_method_id: config.metadata?.payment_method_id,\r\n      transaction_type: config.metadata?.transaction_type,\r\n      listing_id: config.metadata?.listing_id,\r\n      // Optional overrides from UI\r\n      processor: config.metadata?.processor || config.metadata?.payment_processor,\r\n      crypto_chain: config.metadata?.crypto_chain || config.metadata?.chain || config.metadata?.network,\r\n    }\r\n\r\n    const response = await fetch(\"/api/payments/process\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify(payload),\r\n    })\r\n\r\n    if (!response.ok) {\r\n      const error = await response.json()\r\n      return {\r\n        success: false,\r\n        message: error.error || \"Payment processing failed\",\r\n        error: error.error,\r\n      }\r\n    }\r\n\r\n    const result = await response.json()\r\n    return {\r\n      success: true,\r\n      transactionId: result.transaction_id,\r\n      reference: result.reference,\r\n      message: \"Payment processed successfully\",\r\n      nextAction: result.next_action,\r\n    }\r\n  } catch (error) {\r\n    return {\r\n      success: false,\r\n      message: \"Payment processing error\",\r\n      error: String(error),\r\n    }\r\n  }\r\n}\r\n\r\nexport async function createWithdrawal(\r\n  amount: number,\r\n  paymentMethodId: string\r\n): Promise<PaymentResult> {\r\n  try {\r\n    const response = await fetch(\"/api/payments/withdraw\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({ amount, payment_method_id: paymentMethodId }),\r\n    })\r\n\r\n    if (!response.ok) {\r\n      const error = await response.json()\r\n      return {\r\n        success: false,\r\n        message: error.error || \"Withdrawal request failed\",\r\n        error: error.error,\r\n      }\r\n    }\r\n\r\n    const result = await response.json()\r\n    return {\r\n      success: true,\r\n      transactionId: result.withdrawal_id,\r\n      message: result.message,\r\n    }\r\n  } catch (error) {\r\n    return {\r\n      success: false,\r\n      message: \"Withdrawal request error\",\r\n      error: String(error),\r\n    }\r\n  }\r\n}\r\n\r\nexport async function getPaymentMethods() {\r\n  try {\r\n    const response = await fetch(\"/api/payments/methods\")\r\n    if (!response.ok) throw new Error(\"Failed to fetch payment methods\")\r\n    return await response.json()\r\n  } catch (error) {\r\n    console.error(\"Error fetching payment methods:\", error)\r\n    return { success: false, methods: [] }\r\n  }\r\n}\r\n\r\nexport async function deletePaymentMethod(methodId: string): Promise<PaymentResult> {\r\n  try {\r\n    const response = await fetch(`/api/payments/methods?id=${methodId}`, {\r\n      method: \"DELETE\",\r\n    })\r\n\r\n    if (!response.ok) {\r\n      const error = await response.json()\r\n      return {\r\n        success: false,\r\n        message: error.error || \"Failed to delete payment method\",\r\n        error: error.error,\r\n      }\r\n    }\r\n\r\n    const result = await response.json()\r\n    return {\r\n      success: true,\r\n      message: result.message,\r\n    }\r\n  } catch (error) {\r\n    return {\r\n      success: false,\r\n      message: \"Payment method deletion error\",\r\n      error: String(error),\r\n    }\r\n  }\r\n}\r\n\r\nexport async function getTransactions(\r\n  limit?: number,\r\n  status?: string,\r\n  type?: string\r\n) {\r\n  try {\r\n    const params = new URLSearchParams()\r\n    if (limit) params.append(\"limit\", limit.toString())\r\n    if (status) params.append(\"status\", status)\r\n    if (type) params.append(\"type\", type)\r\n\r\n    const response = await fetch(`/api/payments/transactions?${params}`)\r\n    if (!response.ok) throw new Error(\"Failed to fetch transactions\")\r\n    return await response.json()\r\n  } catch (error) {\r\n    console.error(\"Error fetching transactions:\", error)\r\n    return { success: false, transactions: [] }\r\n  }\r\n}\r\n"],"names":[],"mappings":"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"}