module.exports=[93569,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(915618),e=a.i(824569),f=a.i(781560),g=a.i(587532),h=a.i(101239),i=a.i(458988),j=a.i(292e3),k=a.i(797063),l=a.i(933561),l=l,m=a.i(321161),n=a.i(596221),o=a.i(703130),p=a.i(340695),q=a.i(205522),r=a.i(917171),s=a.i(546893),t=a.i(965733),u=a.i(588237),v=a.i(254161),w=a.i(887682),x=a.i(46143),y=a.i(277687),z=a.i(50944),A=a.i(905094);let B=[{value:"update",label:"Update",icon:k.Info,color:"bg-blue-500/10 text-blue-600"},{value:"critical",label:"Critical",icon:j.AlertCircle,color:"bg-red-500/10 text-red-600"},{value:"partnership",label:"Partnership",icon:l.default,color:"bg-green-500/10 text-green-600"},{value:"maintenance",label:"Maintenance",icon:m.Settings,color:"bg-yellow-500/10 text-yellow-600"}],C=[{value:"all",label:"All Users"},{value:"verified",label:"Verified Users Only"},{value:"unverified",label:"Unverified Users Only"},{value:"specific_role",label:"Specific Role"}];function D({announcements:a,currentUserId:j}){let k=(0,z.useRouter)(),{toast:l}=(0,y.useToast)(),[m,D]=(0,c.useState)(a),[E,F]=(0,c.useState)(""),[G,H]=(0,c.useState)(!1),[I,J]=(0,c.useState)(!1),[K,L]=(0,c.useState)(null),[M,N]=(0,c.useState)(!1),[O,P]=(0,c.useState)({title:"",content:"",type:"update",priority:"0",is_pinned:!1,is_active:!0,scheduled_at:"",expires_at:"",target_audience:"all",target_role:""}),Q=m.filter(a=>a.title.toLowerCase().includes(E.toLowerCase())||a.content.toLowerCase().includes(E.toLowerCase())),R=async a=>{N(!0);try{let b=await fetch(`/api/admin/announcements/${a.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({is_pinned:!a.is_pinned})});if(!b.ok){let a=await b.json();throw Error(a.error||"Failed to update announcement")}l({title:"Success",description:a.is_pinned?"Announcement unpinned":"Announcement pinned"}),k.refresh()}catch(a){l({title:"Error",description:a.message,variant:"destructive"})}finally{N(!1)}},S=async()=>{N(!0);try{let a=K?`/api/admin/announcements/${K.id}`:"/api/admin/announcements",b=K?"PATCH":"POST",c={title:O.title,content:O.content,type:O.type,priority:parseInt(O.priority)||0,is_pinned:O.is_pinned,is_active:O.is_active,target_audience:O.target_audience};O.scheduled_at&&(c.scheduled_at=new Date(O.scheduled_at).toISOString()),O.expires_at&&(c.expires_at=new Date(O.expires_at).toISOString()),"specific_role"===O.target_audience&&O.target_role&&(c.target_role=O.target_role);let d=await fetch(a,{method:b,headers:{"Content-Type":"application/json"},body:JSON.stringify(c)}),e=await d.json();if(!d.ok)throw Error(e.error||"Failed to save announcement");l({title:"Success",description:K?"Announcement updated":"Announcement created"}),H(!1),k.refresh()}catch(a){l({title:"Error",description:a.message,variant:"destructive"})}finally{N(!1)}},T=async()=>{N(!0);try{let a=await fetch(`/api/admin/announcements/${K.id}`,{method:"DELETE"});if(!a.ok){let b=await a.json();throw Error(b.error||"Failed to delete announcement")}l({title:"Success",description:"Announcement deleted"}),J(!1),k.refresh()}catch(a){l({title:"Error",description:a.message,variant:"destructive"})}finally{N(!1)}};return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Announcement Management"}),(0,b.jsx)("p",{className:"text-muted-foreground mt-1",children:"Create and manage official platform announcements"})]}),(0,b.jsxs)(p.Button,{onClick:()=>{L(null),P({title:"",content:"",type:"update",priority:"0",is_pinned:!1,is_active:!0,scheduled_at:"",expires_at:"",target_audience:"all",target_role:""}),H(!0)},className:"gap-2",children:[(0,b.jsx)(d.Plus,{className:"h-4 w-4"}),"New Announcement"]})]}),(0,b.jsxs)(o.Card,{children:[(0,b.jsx)(o.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(o.CardTitle,{children:"Announcements"}),(0,b.jsxs)(o.CardDescription,{children:[Q.length," announcements"]})]}),(0,b.jsxs)("div",{className:"relative w-64",children:[(0,b.jsx)(g.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(q.Input,{placeholder:"Search announcements...",className:"pl-10",value:E,onChange:a=>F(a.target.value)})]})]})}),(0,b.jsx)(o.CardContent,{children:(0,b.jsxs)(u.Table,{children:[(0,b.jsx)(u.TableHeader,{children:(0,b.jsxs)(u.TableRow,{children:[(0,b.jsx)(u.TableHead,{children:"Title"}),(0,b.jsx)(u.TableHead,{children:"Type"}),(0,b.jsx)(u.TableHead,{children:"Status"}),(0,b.jsx)(u.TableHead,{children:"Audience"}),(0,b.jsx)(u.TableHead,{children:"Priority"}),(0,b.jsx)(u.TableHead,{children:"Views"}),(0,b.jsx)(u.TableHead,{children:"Actions"})]})}),(0,b.jsx)(u.TableBody,{children:Q.map(a=>{let c;return(0,b.jsxs)(u.TableRow,{children:[(0,b.jsx)(u.TableCell,{className:"font-medium",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[a.is_pinned&&(0,b.jsx)(h.Pin,{className:"h-4 w-4 text-primary"}),a.title]})}),(0,b.jsx)(u.TableCell,{children:(0,b.jsx)(v.Badge,{variant:"outline",className:(c=a.type,B.find(a=>a.value===c)?.color||"bg-gray-500/10 text-gray-600"),children:a.type})}),(0,b.jsx)(u.TableCell,{children:(0,b.jsx)(v.Badge,{variant:a.is_active?"default":"secondary",children:a.is_active?"Active":"Inactive"})}),(0,b.jsx)(u.TableCell,{className:"capitalize",children:a.target_audience||"all"}),(0,b.jsx)(u.TableCell,{children:a.priority||0}),(0,b.jsx)(u.TableCell,{children:a.view_count||0}),(0,b.jsx)(u.TableCell,{children:(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(p.Button,{variant:"ghost",size:"icon",onClick:()=>R(a),disabled:M,children:a.is_pinned?(0,b.jsx)(i.PinOff,{className:"h-4 w-4"}):(0,b.jsx)(h.Pin,{className:"h-4 w-4"})}),(0,b.jsx)(p.Button,{variant:"ghost",size:"icon",onClick:()=>{L(a),P({title:a.title,content:a.content,type:a.type||"update",priority:a.priority?.toString()||"0",is_pinned:a.is_pinned||!1,is_active:!1!==a.is_active,scheduled_at:a.scheduled_at?new Date(a.scheduled_at).toISOString().slice(0,16):"",expires_at:a.expires_at?new Date(a.expires_at).toISOString().slice(0,16):"",target_audience:a.target_audience||"all",target_role:a.target_role||""}),H(!0)},children:(0,b.jsx)(e.Edit,{className:"h-4 w-4"})}),(0,b.jsx)(p.Button,{variant:"ghost",size:"icon",onClick:()=>{L(a),J(!0)},children:(0,b.jsx)(f.Trash2,{className:"h-4 w-4 text-destructive"})})]})})]},a.id)})})]})})]}),(0,b.jsx)(t.Dialog,{open:G,onOpenChange:H,children:(0,b.jsxs)(t.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)(t.DialogHeader,{children:[(0,b.jsx)(t.DialogTitle,{children:K?"Edit Announcement":"Create Announcement"}),(0,b.jsx)(t.DialogDescription,{children:K?"Update announcement information":"Create a new official announcement"})]}),(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{children:"Title *"}),(0,b.jsx)(q.Input,{value:O.title,onChange:a=>P({...O,title:a.target.value}),placeholder:"Announcement title"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{children:"Content *"}),(0,b.jsx)(s.Textarea,{value:O.content,onChange:a=>P({...O,content:a.target.value}),placeholder:"Announcement content (supports markdown)",rows:8})]}),(0,b.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{children:"Type *"}),(0,b.jsxs)(w.Select,{value:O.type,onValueChange:a=>P({...O,type:a}),children:[(0,b.jsx)(w.SelectTrigger,{children:(0,b.jsx)(w.SelectValue,{})}),(0,b.jsx)(w.SelectContent,{children:B.map(a=>(0,b.jsx)(w.SelectItem,{value:a.value,children:a.label},a.value))})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{children:"Priority"}),(0,b.jsx)(q.Input,{type:"number",value:O.priority,onChange:a=>P({...O,priority:a.target.value}),placeholder:"0",min:"0"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Higher number = higher priority"})]})]}),(0,b.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{children:"Target Audience *"}),(0,b.jsxs)(w.Select,{value:O.target_audience,onValueChange:a=>P({...O,target_audience:a}),children:[(0,b.jsx)(w.SelectTrigger,{children:(0,b.jsx)(w.SelectValue,{})}),(0,b.jsx)(w.SelectContent,{children:C.map(a=>(0,b.jsx)(w.SelectItem,{value:a.value,children:a.label},a.value))})]})]}),"specific_role"===O.target_audience&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{children:"Target Role"}),(0,b.jsxs)(w.Select,{value:O.target_role,onValueChange:a=>P({...O,target_role:a}),children:[(0,b.jsx)(w.SelectTrigger,{children:(0,b.jsx)(w.SelectValue,{placeholder:"Select role"})}),(0,b.jsxs)(w.SelectContent,{children:[(0,b.jsx)(w.SelectItem,{value:"builder",children:"Builder"}),(0,b.jsx)(w.SelectItem,{value:"institution",children:"Institution"}),(0,b.jsx)(w.SelectItem,{value:"business",children:"Business"}),(0,b.jsx)(w.SelectItem,{value:"company",children:"Company"}),(0,b.jsx)(w.SelectItem,{value:"organization",children:"Organization"})]})]})]})]}),(0,b.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{children:"Scheduled At (Optional)"}),(0,b.jsx)(q.Input,{type:"datetime-local",value:O.scheduled_at,onChange:a=>P({...O,scheduled_at:a.target.value})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{children:"Expires At (Optional)"}),(0,b.jsx)(q.Input,{type:"datetime-local",value:O.expires_at,onChange:a=>P({...O,expires_at:a.target.value})})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(x.Checkbox,{id:"is_pinned",checked:O.is_pinned,onCheckedChange:a=>P({...O,is_pinned:a})}),(0,b.jsx)(r.Label,{htmlFor:"is_pinned",className:"cursor-pointer",children:"Pin announcement"})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(x.Checkbox,{id:"is_active",checked:O.is_active,onCheckedChange:a=>P({...O,is_active:a})}),(0,b.jsx)(r.Label,{htmlFor:"is_active",className:"cursor-pointer",children:"Active"})]})]})]}),(0,b.jsxs)(t.DialogFooter,{children:[(0,b.jsx)(p.Button,{variant:"outline",onClick:()=>H(!1),children:"Cancel"}),(0,b.jsxs)(p.Button,{onClick:S,disabled:M||!O.title||!O.content,children:[M&&(0,b.jsx)(n.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),K?"Update":"Create"]})]})]})}),(0,b.jsx)(A.AlertDialog,{open:I,onOpenChange:J,children:(0,b.jsxs)(A.AlertDialogContent,{children:[(0,b.jsxs)(A.AlertDialogHeader,{children:[(0,b.jsx)(A.AlertDialogTitle,{children:"Are you sure?"}),(0,b.jsxs)(A.AlertDialogDescription,{children:['This will delete the announcement "',K?.title,'". This action cannot be undone.']})]}),(0,b.jsxs)(A.AlertDialogFooter,{children:[(0,b.jsx)(A.AlertDialogCancel,{children:"Cancel"}),(0,b.jsxs)(A.AlertDialogAction,{onClick:T,disabled:M,children:[M&&(0,b.jsx)(n.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Delete"]})]})]})})]})}a.s(["AnnouncementManagement",()=>D],93569)}];

//# sourceMappingURL=components_admin_announcement-management_tsx_c2ed3d71._.js.map