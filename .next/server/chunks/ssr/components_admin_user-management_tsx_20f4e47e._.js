module.exports=[64914,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(346271),e=a.i(587532),f=a.i(879360),g=a.i(603314),h=a.i(558392),h=h,i=a.i(503211),i=i,j=a.i(816201),k=a.i(992258),l=a.i(177156),m=a.i(284505),n=a.i(717371),o=a.i(703130),p=a.i(340695),q=a.i(205522),r=a.i(254161),s=a.i(807706),t=a.i(887682),u=a.i(676504),v=a.i(965733),w=a.i(588237),x=a.i(269240),y=a.i(50944);function z({users:a}){let z=(0,y.useRouter)(),A=(0,x.createClient)(),[B,C]=(0,c.useState)(a),[D,E]=(0,c.useState)(""),[F,G]=(0,c.useState)("all"),[H,I]=(0,c.useState)("all"),[J,K]=(0,c.useState)(null),[L,M]=(0,c.useState)(null),[N,O]=(0,c.useState)(!1),[P,Q]=(0,c.useState)(!1),[R,S]=(0,c.useState)({offset:0,limit:20,total:0}),T=async()=>{if(!D.trim()&&"all"===F&&"all"===H)return void C(a);Q(!0);try{let a=new URLSearchParams;D&&a.append("q",D),"all"!==F&&a.append("role",F),"verified"===H&&a.append("verified","true"),"unverified"===H&&a.append("verified","false");let b=await fetch(`/api/users/search?${a}`),c=await b.json();c.data&&(C(c.data),S(c.pagination))}catch(a){console.error("Search error:",a)}finally{Q(!1)}},U=async(a,b)=>{O(!0);try{switch(a){case"verify":await A.from("profiles").update({is_verified:!0}).eq("id",b.id),C(B.map(a=>a.id===b.id?{...a,is_verified:!0}:a));break;case"unverify":await A.from("profiles").update({is_verified:!1}).eq("id",b.id),C(B.map(a=>a.id===b.id?{...a,is_verified:!1}:a));break;case"suspend":await A.from("profiles").update({is_suspended:!0}).eq("id",b.id),C(B.map(a=>a.id===b.id?{...a,is_suspended:!0}:a));break;case"unsuspend":await A.from("profiles").update({is_suspended:!1}).eq("id",b.id),C(B.map(a=>a.id===b.id?{...a,is_suspended:!1}:a));break;case"make_admin":await A.from("profiles").update({role:"admin"}).eq("id",b.id),C(B.map(a=>a.id===b.id?{...a,role:"admin"}:a));break;case"make_verifier":await A.from("profiles").update({role:"verifier"}).eq("id",b.id),C(B.map(a=>a.id===b.id?{...a,role:"verifier"}:a));break;case"remove_role":await A.from("profiles").update({role:"user"}).eq("id",b.id),C(B.map(a=>a.id===b.id?{...a,role:"user"}:a))}z.refresh()}catch(a){console.error("Error performing action:",a)}finally{O(!1),M(null)}},V={total:B.length,verified:B.filter(a=>a.is_verified).length,admins:B.filter(a=>"admin"===a.role).length,suspended:B.filter(a=>a.is_suspended).length};return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"User Management"}),(0,b.jsx)("p",{className:"text-muted-foreground mt-1",children:"Manage platform users and permissions"})]}),(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsxs)(p.Button,{variant:"outline",className:"gap-2 bg-transparent",children:[(0,b.jsx)(m.Download,{className:"h-4 w-4"}),"Export"]}),(0,b.jsxs)(p.Button,{className:"gap-2",children:[(0,b.jsx)(n.UserPlus,{className:"h-4 w-4"}),"Invite User"]})]})]}),(0,b.jsxs)("div",{className:"grid gap-4 sm:grid-cols-4",children:[(0,b.jsx)(o.Card,{children:(0,b.jsxs)(o.CardContent,{className:"p-4",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total Users"}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:V.total})]})}),(0,b.jsx)(o.Card,{children:(0,b.jsxs)(o.CardContent,{className:"p-4",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Verified"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-green-600",children:V.verified})]})}),(0,b.jsx)(o.Card,{children:(0,b.jsxs)(o.CardContent,{className:"p-4",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Admins"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:V.admins})]})}),(0,b.jsx)(o.Card,{children:(0,b.jsxs)(o.CardContent,{className:"p-4",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Suspended"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-red-600",children:V.suspended})]})})]}),(0,b.jsx)(o.Card,{children:(0,b.jsx)(o.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,b.jsxs)("div",{className:"relative flex-1",children:[(0,b.jsx)(e.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(q.Input,{placeholder:"Search by name or email...",className:"pl-10",value:D,onChange:a=>E(a.target.value),onKeyDown:a=>"Enter"===a.key&&T()})]}),(0,b.jsx)(p.Button,{onClick:T,disabled:P,variant:"outline",children:P?"Searching...":"Search"}),(0,b.jsxs)(t.Select,{value:F,onValueChange:G,children:[(0,b.jsx)(t.SelectTrigger,{className:"w-40",children:(0,b.jsx)(t.SelectValue,{placeholder:"Role"})}),(0,b.jsxs)(t.SelectContent,{children:[(0,b.jsx)(t.SelectItem,{value:"all",children:"All Roles"}),(0,b.jsx)(t.SelectItem,{value:"user",children:"User"}),(0,b.jsx)(t.SelectItem,{value:"verifier",children:"Verifier"}),(0,b.jsx)(t.SelectItem,{value:"admin",children:"Admin"})]})]}),(0,b.jsxs)(t.Select,{value:H,onValueChange:I,children:[(0,b.jsx)(t.SelectTrigger,{className:"w-40",children:(0,b.jsx)(t.SelectValue,{placeholder:"Status"})}),(0,b.jsxs)(t.SelectContent,{children:[(0,b.jsx)(t.SelectItem,{value:"all",children:"All Status"}),(0,b.jsx)(t.SelectItem,{value:"verified",children:"Verified"}),(0,b.jsx)(t.SelectItem,{value:"unverified",children:"Unverified"}),(0,b.jsx)(t.SelectItem,{value:"suspended",children:"Suspended"})]})]})]})})}),(0,b.jsx)(o.Card,{children:(0,b.jsxs)(o.CardContent,{className:"p-0",children:[(0,b.jsxs)(w.Table,{children:[(0,b.jsx)(w.TableHeader,{children:(0,b.jsxs)(w.TableRow,{children:[(0,b.jsx)(w.TableHead,{children:"User"}),(0,b.jsx)(w.TableHead,{children:"Role"}),(0,b.jsx)(w.TableHead,{children:"Account Type"}),(0,b.jsx)(w.TableHead,{children:"Status"}),(0,b.jsx)(w.TableHead,{children:"Reputation"}),(0,b.jsx)(w.TableHead,{children:"Joined"}),(0,b.jsx)(w.TableHead,{className:"text-right",children:"Actions"})]})}),(0,b.jsx)(w.TableBody,{children:B.map((a,c)=>(0,b.jsxs)(d.motion.tr,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.02*c},className:"group",children:[(0,b.jsx)(w.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)(s.Avatar,{className:"h-9 w-9",children:[(0,b.jsx)(s.AvatarImage,{src:a.avatar_url||"/placeholder.svg"}),(0,b.jsx)(s.AvatarFallback,{children:a.full_name?.charAt(0)||"U"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:a.full_name||"Unknown"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.email})]})]})}),(0,b.jsx)(w.TableCell,{children:(0,b.jsx)(r.Badge,{variant:"admin"===a.role?"default":"verifier"===a.role?"secondary":"outline",className:"capitalize",children:a.role||"user"})}),(0,b.jsx)(w.TableCell,{className:"capitalize",children:a.account_type||"individual"}),(0,b.jsx)(w.TableCell,{children:(0,b.jsx)("div",{className:"flex items-center gap-2",children:a.is_suspended?(0,b.jsx)(r.Badge,{variant:"destructive",children:"Suspended"}):a.is_verified?(0,b.jsx)(r.Badge,{className:"bg-green-500/10 text-green-600",children:"Verified"}):(0,b.jsx)(r.Badge,{variant:"secondary",children:"Pending"})})}),(0,b.jsx)(w.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)("span",{className:"font-medium",children:a.reputation_score||0}),(0,b.jsx)("span",{className:"text-muted-foreground text-xs",children:"pts"})]})}),(0,b.jsx)(w.TableCell,{className:"text-muted-foreground",children:new Date(a.created_at).toLocaleDateString()}),(0,b.jsx)(w.TableCell,{className:"text-right",children:(0,b.jsxs)(u.DropdownMenu,{children:[(0,b.jsx)(u.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(p.Button,{variant:"ghost",size:"icon",className:"opacity-0 group-hover:opacity-100",children:(0,b.jsx)(f.MoreVertical,{className:"h-4 w-4"})})}),(0,b.jsxs)(u.DropdownMenuContent,{align:"end",children:[(0,b.jsx)(u.DropdownMenuLabel,{children:"Actions"}),(0,b.jsx)(u.DropdownMenuSeparator,{}),(0,b.jsxs)(u.DropdownMenuItem,{onClick:()=>K(a),children:[(0,b.jsx)(l.Eye,{className:"h-4 w-4 mr-2"}),"View Profile"]}),(0,b.jsxs)(u.DropdownMenuItem,{children:[(0,b.jsx)(k.Mail,{className:"h-4 w-4 mr-2"}),"Send Email"]}),(0,b.jsx)(u.DropdownMenuSeparator,{}),a.is_verified?(0,b.jsxs)(u.DropdownMenuItem,{onClick:()=>M({type:"unverify",user:a}),children:[(0,b.jsx)(h.default,{className:"h-4 w-4 mr-2"}),"Remove Verification"]}):(0,b.jsxs)(u.DropdownMenuItem,{onClick:()=>M({type:"verify",user:a}),children:[(0,b.jsx)(g.Shield,{className:"h-4 w-4 mr-2"}),"Verify User"]}),"admin"!==a.role&&(0,b.jsxs)(u.DropdownMenuItem,{onClick:()=>M({type:"make_admin",user:a}),children:[(0,b.jsx)(g.Shield,{className:"h-4 w-4 mr-2"}),"Make Admin"]}),"verifier"!==a.role&&"admin"!==a.role&&(0,b.jsxs)(u.DropdownMenuItem,{onClick:()=>M({type:"make_verifier",user:a}),children:[(0,b.jsx)(j.CheckCircle,{className:"h-4 w-4 mr-2"}),"Make Verifier"]}),"user"!==a.role&&(0,b.jsxs)(u.DropdownMenuItem,{onClick:()=>M({type:"remove_role",user:a}),children:[(0,b.jsx)(h.default,{className:"h-4 w-4 mr-2"}),"Remove Role"]}),(0,b.jsx)(u.DropdownMenuSeparator,{}),a.is_suspended?(0,b.jsxs)(u.DropdownMenuItem,{onClick:()=>M({type:"unsuspend",user:a}),className:"text-green-600",children:[(0,b.jsx)(j.CheckCircle,{className:"h-4 w-4 mr-2"}),"Unsuspend User"]}):(0,b.jsxs)(u.DropdownMenuItem,{onClick:()=>M({type:"suspend",user:a}),className:"text-destructive",children:[(0,b.jsx)(i.default,{className:"h-4 w-4 mr-2"}),"Suspend User"]})]})]})})]},a.id))})]}),0===B.length&&(0,b.jsx)("div",{className:"text-center py-12",children:(0,b.jsx)("p",{className:"text-muted-foreground",children:"No users found matching your criteria"})})]})}),(0,b.jsx)(v.Dialog,{open:!!L,onOpenChange:()=>M(null),children:(0,b.jsxs)(v.DialogContent,{children:[(0,b.jsxs)(v.DialogHeader,{children:[(0,b.jsx)(v.DialogTitle,{children:"Confirm Action"}),(0,b.jsxs)(v.DialogDescription,{children:[L?.type==="verify"&&`Are you sure you want to verify ${L.user.full_name}?`,L?.type==="unverify"&&`Remove verification from ${L?.user.full_name}?`,L?.type==="suspend"&&`Suspend ${L?.user.full_name}? They won't be able to access their account.`,L?.type==="unsuspend"&&`Unsuspend ${L?.user.full_name}?`,L?.type==="make_admin"&&`Make ${L?.user.full_name} an admin?`,L?.type==="make_verifier"&&`Make ${L?.user.full_name} a verifier?`,L?.type==="remove_role"&&`Remove admin/verifier role from ${L?.user.full_name}?`]})]}),(0,b.jsxs)(v.DialogFooter,{children:[(0,b.jsx)(p.Button,{variant:"outline",onClick:()=>M(null),className:"bg-transparent",children:"Cancel"}),(0,b.jsx)(p.Button,{onClick:()=>L&&U(L.type,L.user),disabled:N,variant:L?.type==="suspend"?"destructive":"default",children:N?"Processing...":"Confirm"})]})]})}),(0,b.jsx)(v.Dialog,{open:!!J,onOpenChange:()=>K(null),children:(0,b.jsxs)(v.DialogContent,{className:"max-w-md",children:[(0,b.jsx)(v.DialogHeader,{children:(0,b.jsx)(v.DialogTitle,{children:"User Profile"})}),J&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)(s.Avatar,{className:"h-16 w-16",children:[(0,b.jsx)(s.AvatarImage,{src:J.avatar_url||"/placeholder.svg"}),(0,b.jsx)(s.AvatarFallback,{className:"text-lg",children:J.full_name?.charAt(0)||"U"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold text-lg",children:J.full_name||"Unknown"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:J.email})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Role"}),(0,b.jsx)("p",{className:"font-medium capitalize",children:J.role||"user"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Account Type"}),(0,b.jsx)("p",{className:"font-medium capitalize",children:J.account_type||"individual"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Reputation"}),(0,b.jsxs)("p",{className:"font-medium",children:[J.reputation_score||0," points"]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Joined"}),(0,b.jsx)("p",{className:"font-medium",children:new Date(J.created_at).toLocaleDateString()})]})]}),J.bio&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground text-sm",children:"Bio"}),(0,b.jsx)("p",{className:"text-sm",children:J.bio})]})]})]})})]})}a.s(["UserManagement",()=>z],64914)}];

//# sourceMappingURL=components_admin_user-management_tsx_20f4e47e._.js.map