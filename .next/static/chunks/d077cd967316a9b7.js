(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,970065,e=>{"use strict";var t=e.i(843476),r=e.i(647163);function a({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card",className:(0,r.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...a})}function s({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-header",className:(0,r.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...a})}function i({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-title",className:(0,r.cn)("leading-none font-semibold",e),...a})}function n({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-description",className:(0,r.cn)("text-muted-foreground text-sm",e),...a})}function o({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,r.cn)("px-6",e),...a})}e.s(["Card",()=>a,"CardContent",()=>o,"CardDescription",()=>n,"CardHeader",()=>s,"CardTitle",()=>i])},994179,e=>{"use strict";var t=e.i(843476),r=e.i(991918),a=e.i(225913),s=e.i(647163);let i=(0,a.cva)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function n({className:e,variant:a,asChild:n=!1,...o}){let l=n?r.Slot:"span";return(0,t.jsx)(l,{"data-slot":"badge",className:(0,s.cn)(i({variant:a}),e),...o})}e.s(["Badge",()=>n])},755838,(e,t,r)=>{"use strict";var a=e.r(271645),s="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},i=a.useState,n=a.useEffect,o=a.useLayoutEffect,l=a.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!s(e,r)}catch(e){return!0}}var d="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var r=t(),a=i({inst:{value:r,getSnapshot:t}}),s=a[0].inst,d=a[1];return o(function(){s.value=r,s.getSnapshot=t,c(s)&&d({inst:s})},[e,r,t]),n(function(){return c(s)&&d({inst:s}),e(function(){c(s)&&d({inst:s})})},[e]),l(r),r};r.useSyncExternalStore=void 0!==a.useSyncExternalStore?a.useSyncExternalStore:d},802239,(e,t,r)=>{"use strict";t.exports=e.r(755838)},63270,e=>{"use strict";var t=e.i(843476),r=e.i(271645),a=e.i(30207),s=e.i(934620);e.i(174080);var i=e.i(991918),n=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,a)=>{let s=(0,i.createSlot)(`Primitive.${a}`),n=r.forwardRef((e,r)=>{let{asChild:i,...n}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,t.jsx)(i?s:a,{...n,ref:r})});return n.displayName=`Primitive.${a}`,{...e,[a]:n}},{}),o=e.i(802239);function l(){return()=>{}}var c="Avatar",[d,u]=function(e,a=[]){let s=[],i=()=>{let t=s.map(e=>r.createContext(e));return function(a){let s=a?.[e]||t;return r.useMemo(()=>({[`__scope${e}`]:{...a,[e]:s}}),[a,s])}};return i.scopeName=e,[function(a,i){let n=r.createContext(i);n.displayName=a+"Context";let o=s.length;s=[...s,i];let l=a=>{let{scope:s,children:i,...l}=a,c=s?.[e]?.[o]||n,d=r.useMemo(()=>l,Object.values(l));return(0,t.jsx)(c.Provider,{value:d,children:i})};return l.displayName=a+"Provider",[l,function(t,s){let l=s?.[e]?.[o]||n,c=r.useContext(l);if(c)return c;if(void 0!==i)return i;throw Error(`\`${t}\` must be used within \`${a}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let a=()=>{let a=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let s=a.reduce((t,{useScope:r,scopeName:a})=>{let s=r(e)[`__scope${a}`];return{...t,...s}},{});return r.useMemo(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return a.scopeName=t.scopeName,a}(i,...a)]}(c),[p,m]=d(c),h=r.forwardRef((e,a)=>{let{__scopeAvatar:s,...i}=e,[o,l]=r.useState("idle");return(0,t.jsx)(p,{scope:s,imageLoadingStatus:o,onImageLoadingStatusChange:l,children:(0,t.jsx)(n.span,{...i,ref:a})})});h.displayName=c;var f="AvatarImage",x=r.forwardRef((e,i)=>{let{__scopeAvatar:c,src:d,onLoadingStatusChange:u=()=>{},...p}=e,h=m(f,c),x=function(e,{referrerPolicy:t,crossOrigin:a}){let i=(0,o.useSyncExternalStore)(l,()=>!0,()=>!1),n=r.useRef(null),c=i?(n.current||(n.current=new window.Image),n.current):null,[d,u]=r.useState(()=>y(c,e));return(0,s.useLayoutEffect)(()=>{u(y(c,e))},[c,e]),(0,s.useLayoutEffect)(()=>{let e=e=>()=>{u(e)};if(!c)return;let r=e("loaded"),s=e("error");return c.addEventListener("load",r),c.addEventListener("error",s),t&&(c.referrerPolicy=t),"string"==typeof a&&(c.crossOrigin=a),()=>{c.removeEventListener("load",r),c.removeEventListener("error",s)}},[c,a,t]),d}(d,p),g=(0,a.useCallbackRef)(e=>{u(e),h.onImageLoadingStatusChange(e)});return(0,s.useLayoutEffect)(()=>{"idle"!==x&&g(x)},[x,g]),"loaded"===x?(0,t.jsx)(n.img,{...p,ref:i,src:d}):null});x.displayName=f;var g="AvatarFallback",v=r.forwardRef((e,a)=>{let{__scopeAvatar:s,delayMs:i,...o}=e,l=m(g,s),[c,d]=r.useState(void 0===i);return r.useEffect(()=>{if(void 0!==i){let e=window.setTimeout(()=>d(!0),i);return()=>window.clearTimeout(e)}},[i]),c&&"loaded"!==l.imageLoadingStatus?(0,t.jsx)(n.span,{...o,ref:a}):null});function y(e,t){return e?t?(e.src!==t&&(e.src=t),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}v.displayName=g;var b=e.i(647163);function w({className:e,...r}){return(0,t.jsx)(h,{"data-slot":"avatar",className:(0,b.cn)("relative flex size-8 shrink-0 overflow-hidden rounded-full",e),...r})}function j({className:e,...r}){return(0,t.jsx)(x,{"data-slot":"avatar-image",className:(0,b.cn)("aspect-square size-full",e),...r})}function N({className:e,...r}){return(0,t.jsx)(v,{"data-slot":"avatar-fallback",className:(0,b.cn)("bg-muted flex size-full items-center justify-center rounded-full",e),...r})}e.s(["Avatar",()=>w,"AvatarFallback",()=>N,"AvatarImage",()=>j],63270)},406321,e=>{"use strict";let t=(0,e.i(475254).default)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["default",()=>t])},269638,e=>{"use strict";var t=e.i(406321);e.s(["CheckCircle",()=>t.default])},361653,e=>{"use strict";let t=(0,e.i(475254).default)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["default",()=>t])},63209,e=>{"use strict";var t=e.i(361653);e.s(["AlertCircle",()=>t.default])},717521,e=>{"use strict";let t=(0,e.i(475254).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["default",()=>t])},531278,e=>{"use strict";var t=e.i(717521);e.s(["Loader2",()=>t.default])},184762,e=>{"use strict";var t=e.i(843476),r=e.i(647163);function a({className:e,...a}){return(0,t.jsx)("textarea",{"data-slot":"textarea",className:(0,r.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...a})}e.s(["Textarea",()=>a])},914299,e=>{"use strict";let t=(0,e.i(475254).default)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);e.s(["default",()=>t])},790597,e=>{"use strict";var t=e.i(914299);e.s(["Heart",()=>t.default])},895631,e=>{"use strict";let t=(0,e.i(475254).default)("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);e.s(["default",()=>t])},194983,e=>{"use strict";var t=e.i(895631);e.s(["MessageCircle",()=>t.default])},333037,529071,e=>{"use strict";var t=e.i(475254);let r=(0,t.default)("Repeat2",[["path",{d:"m2 9 3-3 3 3",key:"1ltn5i"}],["path",{d:"M13 18H7a2 2 0 0 1-2-2V6",key:"1r6tfw"}],["path",{d:"m22 15-3 3-3-3",key:"4rnwn2"}],["path",{d:"M11 6h6a2 2 0 0 1 2 2v10",key:"2f72bc"}]]);e.s(["default",()=>r],333037);let a=(0,t.default)("Share",[["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["polyline",{points:"16 6 12 2 8 6",key:"m901s6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"15",key:"1p0rca"}]]);e.s(["default",()=>a],529071)},775549,e=>{"use strict";var t=e.i(843476),r=e.i(271645),a=e.i(846932),s=e.i(790597),i=e.i(194983),n=e.i(333037),n=n,o=e.i(529071),o=o,l=e.i(531278),c=e.i(63209),d=e.i(269638),u=e.i(970065),p=e.i(167881),m=e.i(184762),h=e.i(63270),f=e.i(994179),x=e.i(920755),g=e.i(647163);function v(){let e=(0,x.createClient)(),[v,y]=(0,r.useState)([]),[b,w]=(0,r.useState)(!0),[j,N]=(0,r.useState)(""),[k,S]=(0,r.useState)(!1),[C,E]=(0,r.useState)(new Set),[T,_]=(0,r.useState)(new Set),[A,z]=(0,r.useState)(null),[L,P]=(0,r.useState)(""),[M,B]=(0,r.useState)(null),[$,F]=(0,r.useState)([]),[R,O]=(0,r.useState)(new Set);(0,r.useEffect)(()=>{D(),H()},[]);let D=async()=>{let e=await fetch("/api/discussions/posts?page=1&limit=50"),t=await e.json();y(t.posts||[]),I(t.posts||[]),w(!1)},I=async e=>{if(e&&0!==e.length)try{let t=new Set,r=new Set;await Promise.all(e.map(async e=>{try{let[a,s]=await Promise.all([fetch(`/api/discussions/posts/${e.id}/like`),fetch(`/api/discussions/posts/${e.id}/repost`)]);a.ok&&(await a.json()).liked&&t.add(e.id),s.ok&&(await s.json()).reposted&&r.add(e.id)}catch(e){}})),E(t),_(r)}catch(e){console.error("Error loading user interactions:",e)}},H=()=>{let t=e.channel("public:posts").on("postgres_changes",{event:"*",schema:"public",table:"posts"},e=>{"INSERT"===e.eventType?D():"UPDATE"===e.eventType&&y(t=>t.map(t=>t.id===e.new.id?{...t,likes_count:e.new.likes_count,replies_count:e.new.replies_count,reposts_count:e.new.reposts_count}:t))}).on("postgres_changes",{event:"*",schema:"public",table:"post_reposts"},e=>{("INSERT"===e.eventType||"DELETE"===e.eventType)&&D()}).subscribe();return()=>{e.removeChannel(t)}},K=(e,t)=>{let r=Math.random().toString(36).substr(2,9);F(a=>[...a,{id:r,type:t,message:e}]),setTimeout(()=>{F(e=>e.filter(e=>e.id!==r))},3e3)},U=async()=>{if(!j.trim())return void K("Post cannot be empty","error");if(j.length>280)return void K("Post exceeds 280 characters","error");S(!0);try{if(!(await fetch("/api/discussions/posts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:j})})).ok)throw Error("Failed to create post");N(""),K("Post published!","success"),await D()}catch(e){console.error("Error creating post:",e),K("Failed to publish post","error")}finally{S(!1)}},V=(0,r.useCallback)(async e=>{if(R.has(e))return;let t=C.has(e),r=new Set(C);t?r.delete(e):r.add(e),E(r),O(t=>new Set(t).add(e));try{if(!(await fetch(`/api/discussions/posts/${e}/like`,{method:"POST"})).ok)throw Error("Failed to like post");await D()}catch(e){console.error("Error toggling like:",e),E(C),K("Failed to like post","error")}finally{O(t=>{let r=new Set(t);return r.delete(e),r})}},[C,R,K]),W=(0,r.useCallback)(async e=>{if(R.has(e))return;let t=T.has(e),r=new Set(T);t?r.delete(e):r.add(e),_(r),O(t=>new Set(t).add(e));try{if(!(await fetch(`/api/discussions/posts/${e}/repost`,{method:"POST"})).ok)throw Error("Failed to repost");await D()}catch(e){console.error("Error toggling repost:",e),_(T),K("Failed to repost","error")}finally{O(t=>{let r=new Set(t);return r.delete(e),r})}},[T,R,K]),q=async e=>{if(!L.trim())return void K("Reply cannot be empty","error");try{if(!(await fetch(`/api/discussions/posts/${e}/replies`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:L})})).ok)throw Error("Failed to create reply");P(""),z(null),K("Reply posted!","success"),await D()}catch(e){console.error("Error creating reply:",e),K("Failed to post reply","error")}};return(0,t.jsxs)("div",{className:"max-w-2xl mx-auto space-y-4 pb-8",children:[(0,t.jsx)("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:$.map(e=>(0,t.jsxs)(a.motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:(0,g.cn)("flex items-center gap-2 px-4 py-2 rounded-lg text-white text-sm font-medium","success"===e.type?"bg-green-500":"bg-red-500"),children:["success"===e.type?(0,t.jsx)(d.CheckCircle,{className:"h-4 w-4"}):(0,t.jsx)(c.AlertCircle,{className:"h-4 w-4"}),e.message]},e.id))}),(0,t.jsx)(u.Card,{className:"sticky top-0 z-10 bg-background/95 backdrop-blur border-b",children:(0,t.jsx)(u.CardContent,{className:"p-4",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(m.Textarea,{placeholder:"What's happening?!",value:j,onChange:e=>N(e.target.value.substring(0,280)),onKeyDown:e=>{(e.ctrlKey||e.metaKey)&&"Enter"===e.key&&j.trim()&&U()},className:"resize-none min-h-20 text-base border-0 focus:ring-0 focus:outline-none"}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsxs)("span",{className:(0,g.cn)("text-sm font-medium",j.length>252?"text-orange-500":"text-muted-foreground"),children:[j.length,"/",280]})}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(p.Button,{variant:"ghost",onClick:()=>N(""),disabled:!j.trim(),size:"sm",children:"Clear"}),(0,t.jsx)(p.Button,{onClick:U,disabled:!j.trim()||k||j.length>280,size:"sm",className:"rounded-full px-6 font-bold",children:k?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Posting"]}):"Post"})]})]})]})})}),b?(0,t.jsx)("div",{className:"text-center py-8",children:(0,t.jsx)(l.Loader2,{className:"h-8 w-8 animate-spin mx-auto text-primary"})}):0===v.length?(0,t.jsx)(u.Card,{children:(0,t.jsx)(u.CardContent,{className:"py-12 text-center text-muted-foreground",children:"No posts yet. Be the first to start a discussion!"})}):v.map((e,r)=>{let l,c,d,x,v;return(0,t.jsx)(a.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.05*r},children:(0,t.jsx)(u.Card,{className:"hover:bg-muted/50 transition-colors cursor-pointer border-b hover:border-primary/50",children:(0,t.jsx)(u.CardContent,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsxs)(h.Avatar,{className:"h-12 w-12 shrink-0 ring-1 ring-primary/10",children:[(0,t.jsx)(h.AvatarImage,{src:e.user?.avatar_url||void 0}),(0,t.jsx)(h.AvatarFallback,{children:e.user?.full_name?.charAt(0)||"U"})]}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)("span",{className:"font-bold text-base",children:e.user?.full_name||"Anonymous"}),e.user?.is_verified&&(0,t.jsx)(f.Badge,{variant:"secondary",className:"text-xs gap-1",children:"✓ Verified"}),(0,t.jsx)("span",{className:"text-muted-foreground text-sm",children:"·"}),(0,t.jsx)("span",{className:"text-muted-foreground text-sm hover:underline",children:(l=new Date(e.created_at),d=Math.floor((c=new Date().getTime()-l.getTime())/36e5),x=Math.floor(c/864e5),(v=Math.floor(c/6e4))<60?`${v}m`:d<24?`${d}h`:x<7?`${x}d`:l.toLocaleDateString())})]}),e.category&&"general"!==e.category&&(0,t.jsx)(f.Badge,{variant:"outline",className:"mb-3 capitalize text-xs",children:e.category}),(0,t.jsx)("p",{className:"text-base whitespace-pre-wrap mb-3 leading-relaxed",children:e.content}),(0,t.jsxs)("div",{className:"flex justify-between text-muted-foreground text-sm max-w-xs",children:[(0,t.jsxs)(p.Button,{variant:"ghost",size:"sm",className:"gap-2 h-9 px-0 text-xs hover:text-blue-500 hover:bg-blue-50 dark:hover:bg-blue-950",onClick:()=>z(A===e.id?null:e.id),disabled:R.has(e.id),children:[(0,t.jsx)(i.MessageCircle,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"text-xs",children:e.replies_count})]}),(0,t.jsxs)(p.Button,{variant:"ghost",size:"sm",className:(0,g.cn)("gap-2 h-9 px-0 text-xs hover:text-green-500 hover:bg-green-50 dark:hover:bg-green-950 transition-colors",T.has(e.id)&&"text-green-500"),onClick:()=>W(e.id),disabled:R.has(e.id),children:[(0,t.jsx)(n.default,{className:(0,g.cn)("h-4 w-4",T.has(e.id)&&"fill-current")}),(0,t.jsx)("span",{className:"text-xs",children:e.reposts_count})]}),(0,t.jsxs)(p.Button,{variant:"ghost",size:"sm",className:(0,g.cn)("gap-2 h-9 px-0 text-xs hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-950 transition-colors",C.has(e.id)&&"text-red-500"),onClick:()=>V(e.id),disabled:R.has(e.id),children:[(0,t.jsx)(s.Heart,{className:(0,g.cn)("h-4 w-4",C.has(e.id)&&"fill-current")}),(0,t.jsx)("span",{className:"text-xs",children:e.likes_count})]}),(0,t.jsx)(p.Button,{variant:"ghost",size:"sm",className:"gap-2 h-9 px-0 text-xs hover:text-blue-500 hover:bg-blue-50 dark:hover:bg-blue-950",children:(0,t.jsx)(o.default,{className:"h-4 w-4"})})]}),A===e.id&&(0,t.jsxs)(a.motion.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mt-4 pt-4 border-t space-y-2",children:[(0,t.jsx)(m.Textarea,{placeholder:"Write your reply...",value:L,onChange:e=>P(e.target.value),className:"resize-none min-h-16 text-sm border-0 focus:ring-0",autoFocus:!0}),(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)(p.Button,{variant:"ghost",size:"sm",onClick:()=>{z(null),P("")},children:"Cancel"}),(0,t.jsx)(p.Button,{size:"sm",onClick:()=>q(e.id),disabled:!L.trim(),className:"rounded-full px-4",children:"Reply"})]})]})]})]})})})},e.id)})]})}e.s(["DiscussionFeed",()=>v],775549)}]);